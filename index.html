<head>
    <h1>Witamy</h1>
</head>
<body>
    <p>Drobny programik do szyfrowania/deszyfrowania</p>
    <script>
        let choice=0;
        do{
        choice = window.prompt("Wybierz: Szyfrowanie 1 Deszyfrowanie 2");
        }while(!(choice == 1 || choice ==2))
        const key = window.prompt("Podaj klucz:");
        const message = window.prompt("Podaj wiadomość do przetworzenia:");
        const messagelength=message.length
        let resultmessage=[];
        let temp=[];
        let i = 0;
        const keylength = key.length
        const keymod = Math.floor(Math.sqrt(keylength)*(1+keylength%7))
        const keymod1 = Math.floor(keymod/2)
        i=0;
        let current = 0;
        if(choice==1){
            while(i<messagelength){
                temp[i]=String.fromCharCode((message.charCodeAt(i)+key.charCodeAt(i%keylength))%1048576);
                i++;
            }
            for(i=0;i<messagelength;i++){
                resultmessage[i]=temp[i];
            }
            while(current+keymod<messagelength){
                for(i=0;i<keymod;i++){
                    resultmessage[current+i]=temp[current+(i+keymod1)%keymod];
                }
                current+=keymod;
            }            
        }
        if(choice==2){
            for(i=0;i<messagelength;i++){
                temp[i]=message[i];
            }
            while(current+keymod<messagelength){
                for(i=0;i<keymod;i++){
                    temp[current+i]=message[current+(i+keymod-keymod1)%keymod];
                }
                current+=keymod;
            }
            resultmessage[0]=temp.join("")
            temp=resultmessage[0]
            i=0;    
            while(i<messagelength){
                resultmessage[i]=String.fromCharCode((temp.charCodeAt(i)-key.charCodeAt(i%keylength)+1048576)%1048576);
                i++;
            }
        }
        const resultmessagelength=resultmessage.length
        i=0;
        let result="";
        while(i<resultmessagelength){
            result+=resultmessage[i];
            i++;
        }
    </script>
    <p>Przetworzony tekst:</p>
    <p><script type="text/javascript">document.write(result)</script></p>
</body>